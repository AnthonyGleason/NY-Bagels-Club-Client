{"version":3,"file":"static/js/1799.6b76d42b.chunk.js","mappings":"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","sources":["Assets/icons/bubble-loading.svg","Components/Checkout/CheckoutSuccess/CheckoutSuccess.tsx","Config/clientSettings.ts","Helpers/auth.ts","Helpers/cart.tsx"],"sourcesContent":["var _circle, _circle2, _circle3;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgBubbleLoading(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"1em\",\n    height: \"1em\",\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 12,\n    cy: 3.5,\n    r: 1.5,\n    fill: \"#5d1917\",\n    opacity: 0\n  }, /*#__PURE__*/React.createElement(\"animateTransform\", {\n    attributeName: \"transform\",\n    calcMode: \"discrete\",\n    dur: \"2.4s\",\n    repeatCount: \"indefinite\",\n    type: \"rotate\",\n    values: \"0 12 12;90 12 12;180 12 12;270 12 12\"\n  }), /*#__PURE__*/React.createElement(\"animate\", {\n    attributeName: \"opacity\",\n    dur: \"0.6s\",\n    keyTimes: \"0;0.5;1\",\n    repeatCount: \"indefinite\",\n    values: \"1;1;0\"\n  }))), _circle2 || (_circle2 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 12,\n    cy: 3.5,\n    r: 1.5,\n    fill: \"#5d1917\",\n    opacity: 0\n  }, /*#__PURE__*/React.createElement(\"animateTransform\", {\n    attributeName: \"transform\",\n    begin: \"0.2s\",\n    calcMode: \"discrete\",\n    dur: \"2.4s\",\n    repeatCount: \"indefinite\",\n    type: \"rotate\",\n    values: \"30 12 12;120 12 12;210 12 12;300 12 12\"\n  }), /*#__PURE__*/React.createElement(\"animate\", {\n    attributeName: \"opacity\",\n    begin: \"0.2s\",\n    dur: \"0.6s\",\n    keyTimes: \"0;0.5;1\",\n    repeatCount: \"indefinite\",\n    values: \"1;1;0\"\n  }))), _circle3 || (_circle3 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 12,\n    cy: 3.5,\n    r: 1.5,\n    fill: \"#5d1917\",\n    opacity: 0\n  }, /*#__PURE__*/React.createElement(\"animateTransform\", {\n    attributeName: \"transform\",\n    begin: \"0.4s\",\n    calcMode: \"discrete\",\n    dur: \"2.4s\",\n    repeatCount: \"indefinite\",\n    type: \"rotate\",\n    values: \"60 12 12;150 12 12;240 12 12;330 12 12\"\n  }), /*#__PURE__*/React.createElement(\"animate\", {\n    attributeName: \"opacity\",\n    begin: \"0.4s\",\n    dur: \"0.6s\",\n    keyTimes: \"0;0.5;1\",\n    repeatCount: \"indefinite\",\n    values: \"1;1;0\"\n  }))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgBubbleLoading);\nexport default __webpack_public_path__ + \"static/media/bubble-loading.b33d30713a00cb69a09f4b5a72d38f04.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useRef, useState } from 'react';\nimport './CheckoutSuccess.css';\nimport {Cart, Order} from '../../../Interfaces/interfaces';\nimport Sidebar from '../../Sidebar/Sidebar';\nimport { emptyCart } from '../../../Helpers/cart';\nimport loadingImg from '../../../Assets/icons/bubble-loading.svg';\nimport { getServerUrlPrefix } from '../../../Config/clientSettings';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport Nav from '../../Nav/Nav';\n\nexport default function CheckoutSuccess(){\n  const [orderNumber,setOrderNumber] = useState<string>('');\n  const [isSidebarExpanded,setIsSidebarExpanded] = useState<boolean>(false);\n  const [isSignedIn,setIsSignedIn] = useState<boolean>(false);\n  const [isGuest,setIsGuest] = useState<boolean>(true);\n  \n  const navigate = useNavigate();\n  const params = useParams();\n  const pendingOrderDocID:string | undefined = params.pendingOrderDocID;\n\n  const fetchPlacedOrder = async function(setOrder:Function){\n    if (!pendingOrderDocID) return;\n    const response = await fetch(`${getServerUrlPrefix()}/api/shop/orders/checkout/fetchPlacedOrder/${pendingOrderDocID.toString()}`,{\n      method: 'GET',\n    });\n    const responseData = await response.json();\n    if (responseData.orderNumber){\n      setOrder(responseData.orderNumber);\n      setIsGuest(responseData.isGuest);\n    };\n  };\n\n  const isInitialLoad = useRef(true);\n\n  useEffect(()=>{\n    if (isInitialLoad.current){\n      isInitialLoad.current=false;\n      //clear the users cart on load\n      localStorage.removeItem('cartToken');\n      localStorage.removeItem('clubCartToken');\n      //NOW WE NEED TO SPLIT THE PAYMENT INTENT SECRET SERVERSIDE\n      if (!orderNumber) fetchPlacedOrder(setOrderNumber);\n    }\n  },[]);\n\n  useEffect(() => {\n    // Page is loading\n    let timeoutId:any;\n  \n    if (!orderNumber) {\n      timeoutId = setTimeout(() => {\n        window.location.reload();\n      }, 5000);\n    }\n  \n    return () => {\n      // Cleanup: Clear the timeout when the component unmounts or when the dependency values change\n      clearTimeout(timeoutId);\n    };\n  }, [orderNumber]);\n  \n\n  if (!orderNumber){\n    return(\n      <>\n        <Sidebar \n          cart={emptyCart}\n          isExpanded={isSidebarExpanded} \n          setIsExpanded={setIsSidebarExpanded}\n          isSignedIn={isSignedIn}\n          setIsSignedIn={setIsSignedIn}\n        />\n        <div className='checkout-loading'>\n          <p>Loading...</p>\n          <img src={loadingImg} alt='loading' loading=\"lazy\" />\n        </div>\n      </>\n    )\n  }else if (orderNumber){\n    return(\n      <>\n        <Sidebar\n          cart={emptyCart}\n          isExpanded={isSidebarExpanded} \n          setIsExpanded={setIsSidebarExpanded}\n          isSignedIn={isSignedIn}\n          setIsSignedIn={setIsSignedIn}\n        />\n        <div className='checkout-success'>\n          <div className='checkout-success-content'>\n            <div className='checkout-success-heading-wrapper'>\n              <h3>Your Order Has Been Placed!</h3>\n              <h3>Order #{orderNumber}</h3>\n            </div>\n            <p>Thank you for choosing New York Bagels Club for your purchase. If you have any questions or need assistance with your order, please don't hesitate to reach out. We look forward to delivering your order with care and ensuring your satisfaction. Welcome to the New York Bagels Club family!</p>\n            <p>\n              To track the status of your order please visit the \"Orders\" page.\n            </p>\n            <button className='my-orders' onClick={()=>{navigate('/accounts/orders')}}>View Order</button>\n          </div>\n        </div>\n\n      </>\n    )\n  }else{\n    return(\n      <div>\n        If you are seeing this message it means that an error has occured when processing your order. (This typically is the result of a card decline). \n        If you were charged and do not see your order please contact our customer support and we will review your order.\n      </div>\n    )\n  }\n}","const USE_LOCALHOST:boolean = false; //FALSE FOR PRODUCTION\n\nexport const IS_MAINTENANCE_MODE:boolean = false;\nexport const HOME_LOADING_DELAY:number= 2250 //in milliseconds\n\nexport const getServerUrlPrefix = function(){\n  if (USE_LOCALHOST){\n    return('http://localhost:5000');\n  }else{\n    return('https://nybc-server-f069d08697f3.herokuapp.com');\n  };\n};\n\nexport const getClientUrlPrefix = function(){\n  if (USE_LOCALHOST){\n    return('http://localhost:3000');\n  }else{\n    return('https://anthonygleason.github.io/NY-Bagels-Club-Client')\n  };\n};\nexport const CHECKOUT_SUCCESS_REDIRECT_URL:string = `${getServerUrlPrefix()}/cart/checkout/success`;","import { getServerUrlPrefix } from \"../Config/clientSettings\";\n\nexport const verifyCartToken = async function(setCart:Function, isClub?:boolean):Promise<boolean>{\n  const cartTokenKey = isClub ? 'clubCartToken' : 'cartToken';\n  try{\n    const response = await fetch(`${getServerUrlPrefix()}/api/shop/carts/verify`,{\n      method: 'GET',\n      headers:{\n        'Content-Type': 'application/json',\n        'Cart-Token': `Bearer ${localStorage.getItem(cartTokenKey)}`,\n        'Authorization': `Bearer ${localStorage.getItem('loginToken')}`\n      }\n    });\n    if (response.status!==200) throw new Error('No valid cart detected. Either the user does not have a cart token or the token expired.');\n    const responseData = await response.json();\n    setCart(responseData.cart);\n    return responseData.isValid;\n  }catch(err){\n    console.log(err);\n    return false;\n  };\n};\n\nexport const requestCartToken = async function(isClub:boolean){\n  const response = await fetch(`${getServerUrlPrefix()}/api/shop/carts`,{\n    method: 'POST',\n    headers:{\n      'Content-Type': 'application/json',\n    },\n    body:JSON.stringify({\n      isClub: isClub\n    })\n  });\n  const responseData = await response.json();\n  if (responseData.cartToken){\n    //return the cart session token\n    return responseData.cartToken;  \n  }\n};\n\nexport const verifyLoginToken = async function(\n  setIsSignedIn?:Function,\n  setIsAdmin?:Function,\n  setUserID?:Function\n):Promise<boolean>{\n  let isValid:boolean = false;\n  //handle no login token is present\n  if (!localStorage.getItem('loginToken')){\n    if (setIsSignedIn) setIsSignedIn(false);\n    if (setIsAdmin) setIsAdmin(false);\n    return false;\n  };\n  try{\n    const response = await fetch(`${getServerUrlPrefix()}/api/users/verify`,{\n      method: 'GET',\n      headers:{\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${localStorage.getItem('loginToken')}`\n      }\n    });\n    const responseData = await response.json();\n    //handle 403 unauthorized\n    if (response.ok===false || response.status===403){\n      localStorage.removeItem('loginToken');\n      isValid=false;\n    }else{\n      isValid=responseData.isValid;\n    };\n    if (setIsAdmin && responseData.isAdmin===true) setIsAdmin(true);\n    if (setIsSignedIn) setIsSignedIn(isValid);\n    if (setUserID) setUserID(responseData.userID);\n    return isValid;\n  }catch(err){\n    console.log(err);\n    if (setIsAdmin) setIsAdmin(false);\n    return false;\n  };\n};\n\nexport const handleLogout = async function(setIsSignedIn?:Function){\n  await fetch(`${getServerUrlPrefix()}/api/users/logout`,{\n    method: 'POST',\n    headers:{\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${localStorage.getItem('loginToken')}`\n    }\n  });\n  if (setIsSignedIn) setIsSignedIn(false);\n  //remove the token locally\n  localStorage.removeItem('loginToken');\n};\n\nexport const getMembershipTier = async function(\n    setMembershipTier?:Function,\n    setRemainingDeliveries?:Function,\n    setExpirationDate?:Function\n  ):Promise<string>{\n  try{\n    if (!localStorage.getItem('loginToken')) throw new Error('You are not signed in');\n    const response = await fetch(`${getServerUrlPrefix()}/api/users/membershipLevel`,{\n      method: 'GET',\n      headers:{\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${localStorage.getItem('loginToken')}`\n      }\n    });\n    const responseData = await response.json();\n    if (setMembershipTier) setMembershipTier(responseData.membershipLevel);\n    if (setRemainingDeliveries) setRemainingDeliveries(responseData.remainingDeliveries);\n    if (setExpirationDate) setExpirationDate(new Date(responseData.expirationDate).toDateString());\n    return responseData.membershipLevel;\n  }catch(err){\n    console.log('You are not signed in, showing non-member pricing.');\n    if (setMembershipTier) setMembershipTier('Non-Member');\n    return 'Non-Member';\n  };\n};","import { getServerUrlPrefix } from \"../Config/clientSettings\";\nimport { BagelItem, Cart, CartItem, SpreadItem } from \"../Interfaces/interfaces\";\nimport { requestCartToken, verifyCartToken } from \"./auth\";\n\nexport const modifyCart = async function(\n  updatedQuantity:number,\n  itemID:string,\n  setCart:Function,\n  isRequestPending:boolean,\n  setIsRequestPending:Function,\n  selection: string,\n  isClub:boolean\n){\n  let cartTokenKey:string = '';\n  //handle not a club request & checking for undefined since isClub is optional\n  if (isClub===false){\n    cartTokenKey = 'cartToken';\n  }else{\n    cartTokenKey = 'clubCartToken';\n  };\n\n  try{\n    //handle request is already pending limited users to 1 request at a time\n    if (isRequestPending) throw new Error('A request is already pending. Please wait for the current request to complete.');\n    //set request to pending\n    setIsRequestPending(true);\n    if (!itemID || updatedQuantity<0) throw new Error('One or more required inputs were left blank.');\n    if(!cartTokenKey) throw new Error('Your request for a local storage cart token was invalid. Did you provide a isClub value to this function?');\n    //make a request to the server to update quantity for cart\n    const response = await fetch(`${getServerUrlPrefix()}/api/shop/carts`,{\n      method: 'PUT',\n      headers:{\n        'Content-Type': 'application/json',\n        'Cart-Token': `Bearer ${localStorage.getItem(cartTokenKey)}`,\n        'Authorization': `Bearer ${localStorage.getItem('loginToken')}`\n      },\n      body: JSON.stringify({\n        itemID: itemID,\n        updatedQuantity: updatedQuantity,\n        selection: selection,\n        isClubCart: isClub || undefined\n      })\n    });\n    if (response.status===510){\n      alert('You have reached the maximum allowed quantity for the selected item.');\n    };\n    //if the cart token is invalid request a fresh one and call modifyCart again\n    if (response.status===403){ //BUG WARNING IF 403 IS RETURNED WHEN YOU CANT ADD ANYTHING NEW TO YOUR CLUB CART YOU WILL BE CAUGHT IN AN ENDLESS LOOP OF 403 RESPONSES\n      //request a new cart token\n      localStorage.setItem(cartTokenKey,await requestCartToken(isClub || false));\n      modifyCart(updatedQuantity,itemID,setCart,isRequestPending,setIsRequestPending,selection,isClub);\n    };\n    if (!response.ok) throw new Error('An error occurred in the request to update the cart.');\n    const responseData = await response.json();\n\n    if (responseData.cartToken && responseData.cart){\n      //replace the cartToken in localStorage with the updated cartToken\n      localStorage.setItem(cartTokenKey,responseData.cartToken);\n      //update cart state\n      setCart(responseData.cart);\n    };\n    //allow another request to the server\n    setIsRequestPending(false);\n  }catch(err){\n    setIsRequestPending(false);\n  };\n};\n\nexport const fetchAndHandleCart = async function(setCart:Function,isClub?:boolean){\n  try {\n    const cartTokenKey = isClub ? 'clubCartToken' : 'cartToken';\n    const cartToken: string | null = localStorage.getItem(cartTokenKey);\n    // If a cart token was not found, obtain a fresh one\n    if (!cartToken) {\n      // Request a new cart token\n      localStorage.setItem(cartTokenKey, await requestCartToken(isClub || false));\n    };\n    // If a cart token exists but is invalid\n    if (!await verifyCartToken(setCart,isClub)) { //NOTE THIS VERIFYCART TOKEN IS SETTING A CART\n      localStorage.setItem(cartTokenKey, await requestCartToken(isClub || false));\n      // Because a new cart token was requested, set the cart state back to an empty array\n      setCart([]);\n    };\n  } catch (err) {\n    console.log(err);\n  };  \n};\n\nexport const getUnitPriceFromCartItem = function(storeItem:SpreadItem | BagelItem, selection?:string):number{\n  let price:number = 0;\n  if (storeItem.cat==='bagel' && selection==='two'){\n    const tempStoreItem:BagelItem = storeItem as BagelItem;\n    price = tempStoreItem.twoPrice;\n  }else if (storeItem.cat==='bagel' && selection==='six'){\n    const tempStoreItem:BagelItem = storeItem as BagelItem;\n    price = tempStoreItem.sixPrice;\n  }else if (storeItem.cat==='bagel' && selection==='dozen'){\n    const tempStoreItem:BagelItem = storeItem as BagelItem;\n    price = tempStoreItem.dozenPrice;\n  }else if (storeItem.cat==='spread'){\n    const tempCartItem:SpreadItem = storeItem as SpreadItem;\n    price = tempCartItem.price;\n  };\n  return price;\n};\n\nexport const handleCartItemInputChange = function(\n  e:any,\n  setCartQuantity:Function,\n  cartItem:CartItem,\n  setCart:Function,\n  isRequestPending:boolean,\n  setIsRequestPending:Function,\n  selection: string,\n  isClub:boolean\n){ //accepts an event from an input onChange \n  const newVal: number = parseInt(e.target.value);\n  //we dont want users to accidently delete their cart so lets prevent that\n  if (!newVal) {\n    setCartQuantity('');\n    return ;\n  };\n  modifyCart(\n    newVal,\n    cartItem.itemData._id,\n    setCart,\n    isRequestPending,\n    setIsRequestPending,\n    selection,\n    isClub\n  );\n};\n\nexport const getSelectionName = function(cartItem:CartItem){\n  if (cartItem.itemData.cat==='bagel' && cartItem.selection==='six') return 'Six Pack(s)';\n  if (cartItem.itemData.cat==='bagel' && cartItem.selection==='dozen') return \"Baker's Dozen(s)\";\n  if (cartItem.itemData.cat==='bagel' && cartItem.selection==='two') return 'Two Pack(s)';\n\n  //need to have this first because the current store items without category of spread show \n  if (cartItem.itemData.cat==='spread' && cartItem.selection==='halflb') return '1/2 LB';\n  if (cartItem.itemData.cat==='spread') return 'One Pound';\n  \n  if (cartItem.itemData.cat==='pastry') return 'Six Pack(s)';\n  if (cartItem.itemData.cat==='mystery') return 'Single(s)';\n  return 'N/A';\n};\n\nexport const getCartItemSubtotal = function(cartItem:CartItem):number{\n  return cartItem.quantity * cartItem.unitPriceInDollars;\n};\n\nexport const getItemQuantityFromCart = function(cart:Cart, itemName: string, selection?: string): number {\n  if (!cart || !cart.items) return 0;\n\n  let quantity = 0;\n\n  for (let index = 0; index < cart.items.length; index++) {\n    const cartItem: CartItem = cart.items[index];\n    \n    // Check if the selection and itemName match\n    if (\n      cartItem.selection === selection &&\n      cartItem.itemData.cat === 'bagel' &&\n      cartItem.itemData.name === itemName\n    ) {\n      quantity = cartItem.quantity;\n      break; // Exit the loop if the item is found\n    }else if(\n      cartItem.itemData.cat === 'spread' &&\n      cartItem.itemData.name === itemName\n    ){\n      quantity = cartItem.quantity;\n      break; // Exit the loop if the item is found\n    }else if(\n      cartItem.itemData.cat === 'pastry' &&\n      cartItem.itemData.name === itemName\n    ){\n      quantity = cartItem.quantity;\n      break;\n    }\n  };\n  return quantity;\n};\n\n\nexport const emptyCart = {\n  items: [],\n  subtotalInDollars: 0,\n  taxInDollars: 0,\n  totalQuantity: 0,\n  discountAmountInDollars: 0,\n  finalPriceInDollars: 0,\n  desiredShipDate: new Date(),\n  isGuest: false\n};\n\nexport const requestApplyMembershipPricingToCart = async function(setCart?:Function):Promise<void>{\n  const cartToken:string | null = localStorage.getItem('cartToken');\n  const loginToken:string | null = localStorage.getItem('loginToken');\n\n  if (cartToken){\n    const response = await fetch(`${getServerUrlPrefix()}/api/shop/carts/applyMembershipPricing`,{\n      method: 'POST',\n      headers:{\n        'Content-Type': 'application/json',\n        'Cart-Token': `Bearer ${cartToken}`,\n        'Authorization': `Bearer ${loginToken}`\n      }\n    });\n    if (response.ok){\n      const responseData = await response.json();\n      localStorage.setItem('cartToken',responseData.cartToken);\n      if (setCart) setCart(responseData.cart);\n      console.log('Membership pricing successfully applied!');\n    }else{\n      console.log('User is not a member.');\n    };\n  };\n};\n\nexport const isClubCartValid = function(clubCart:Cart):boolean{\n  let totalSpreadQuantity = 0;\n  let totalBagelQuantity = 0;\n\n  clubCart.items.map((cartItem)=>{\n    switch (cartItem.itemData.cat){\n      case 'bagel':\n        totalBagelQuantity+=cartItem.quantity;\n        break;\n      case 'spread':\n        totalSpreadQuantity+=cartItem.quantity;\n        break;\n      default:\n        break;\n    };\n  });\n  return (totalSpreadQuantity===1 && totalBagelQuantity===6);\n}\n\nexport const handlePlaceClubOrder = async function(clubCart:Cart,isClubCartValid:boolean,deliveriesRemaining:number,shipDate?:Date){\n  if (!isClubCartValid){\n    alert('To place your order you must have 6 \"Two Packs\" and 1 \"1/2 LB\" spread in your cart.')\n  }else if(!shipDate){\n    alert('You must select a ship date to place your order.');\n  }else if(deliveriesRemaining<=0){\n    alert('You do not have any deliveries remaining this billing cycle.');\n  }else{\n    //request the cart token\n    const response = await fetch(`${getServerUrlPrefix()}/api/memberships/create-club-checkout-session`,{\n      method: 'POST',\n      headers:{\n        'Content-Type': `application/json`,\n        'Authorization': `Bearer ${localStorage.getItem('loginToken')}`,\n        'cart-token': `Bearer ${localStorage.getItem('clubCartToken')}`\n      },\n      body:JSON.stringify({\n        shipDate: shipDate\n      })\n    });\n    const responseData = await response.json();\n    if (responseData.sessionUrl) window.location.href=responseData.sessionUrl;\n  }\n};"],"names":["CheckoutSuccess","orderNumber","setOrderNumber","useState","isSidebarExpanded","setIsSidebarExpanded","isSignedIn","setIsSignedIn","isGuest","setIsGuest","navigate","useNavigate","pendingOrderDocID","useParams","isInitialLoad","useRef","useEffect","current","localStorage","removeItem","async","setOrder","response","fetch","concat","getServerUrlPrefix","toString","method","responseData","json","fetchPlacedOrder","timeoutId","setTimeout","window","location","reload","clearTimeout","_jsxs","_Fragment","children","_jsx","Sidebar","cart","emptyCart","isExpanded","setIsExpanded","className","onClick","src","loadingImg","alt","loading","IS_MAINTENANCE_MODE","HOME_LOADING_DELAY","getClientUrlPrefix","verifyCartToken","setCart","isClub","cartTokenKey","headers","getItem","status","Error","isValid","err","console","log","requestCartToken","body","JSON","stringify","cartToken","verifyLoginToken","setIsAdmin","setUserID","ok","isAdmin","userID","handleLogout","getMembershipTier","setMembershipTier","setRemainingDeliveries","setExpirationDate","membershipLevel","remainingDeliveries","Date","expirationDate","toDateString","modifyCart","updatedQuantity","itemID","isRequestPending","setIsRequestPending","selection","isClubCart","undefined","alert","setItem","fetchAndHandleCart","handleCartItemInputChange","e","setCartQuantity","cartItem","newVal","parseInt","target","value","itemData","_id","getSelectionName","cat","getCartItemSubtotal","quantity","unitPriceInDollars","getItemQuantityFromCart","itemName","items","index","length","name","subtotalInDollars","taxInDollars","totalQuantity","discountAmountInDollars","finalPriceInDollars","desiredShipDate","requestApplyMembershipPricingToCart","loginToken","isClubCartValid","clubCart","totalSpreadQuantity","totalBagelQuantity","map","handlePlaceClubOrder","deliveriesRemaining","shipDate","sessionUrl","href"],"sourceRoot":""}