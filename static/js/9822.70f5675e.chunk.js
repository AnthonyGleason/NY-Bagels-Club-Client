"use strict";(self.webpackChunknew_york_bagels_club=self.webpackChunknew_york_bagels_club||[]).push([[9822,3190],{5241:(e,t,s)=>{s.d(t,{Z:()=>r});s(2791);const r=s.p+"static/media/x.b3295ae9ce0a3b7b53fbb42a0c049fa1.svg"},6117:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var r=s(2791),n=s(4545),a=s(5262),i=s(7579);const c=s.p+"static/media/pulls.9acab1979af61137e8e007c9e2cbb12d.svg";var o=s(184);function l(e){let{allOrders:t}=e;const[s,n]=(0,r.useState)(!1),[a,l]=(0,r.useState)([]),[d,h]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const e=t.filter((e=>"Pending"===e.status?1:0));h(e)}),[t]),(0,r.useEffect)((()=>{const e=[];d.forEach((t=>{t.cart.items.forEach((t=>{let s=null;e.map(((e,r)=>{t.itemData.name===e.itemData.name&&t.selection===e.selection&&t.itemData.cat===e.itemData.cat&&(s=r)})),s?e[s].quantity+=t.quantity:e.push(t)}))})),l(e)}),[d]),s?(0,o.jsxs)("section",{className:"pending-orders-panel-wrapper",children:[(0,o.jsxs)("h3",{onClick:()=>{n(!1)},children:[(0,o.jsx)("img",{src:c,alt:"pulls"}),(0,o.jsx)("span",{children:"Pending Orders Pulls"})]}),(0,o.jsx)("ul",{className:"pending-orders-panel-content",children:a?a.map(((e,t)=>(0,o.jsxs)("li",{children:[(0,o.jsx)("p",{children:e.itemData.name}),(0,o.jsx)("p",{children:e.quantity+" "+(0,i.Lb)(e)}),(0,o.jsx)("input",{type:"checkbox"})]},t))):null})]}):(0,o.jsx)("section",{children:(0,o.jsxs)("h3",{onClick:()=>{n(!0)},children:[(0,o.jsx)("img",{src:c,alt:"pulls"}),(0,o.jsx)("span",{children:"Pending Orders Pulls"})]})})}var d=s(6795);const h=async function(e){const t=await fetch("".concat((0,d.F1)(),"/api/admin/orders/").concat(e._id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))},body:JSON.stringify({status:e.status,trackingNumberArr:e.trackingNumberArr,giftMessage:e.giftMessage})});await t.json()},u=async function(e,t){t&&p(t,e);{const t=await fetch("".concat((0,d.F1)(),"/api/admin/orders"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}}),s=await t.json();return e(s.orders),s.orders}},p=async function(e,t){const s=await fetch("".concat((0,d.F1)(),"/api/admin/orders/search/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}}),r=await s.json();r.results?t(r.results):t([])};var g=s(5241);function m(e){let{trackingNumber:t,trackingNumberArr:s,order:n,allOrders:a,setAllOrders:i,index:c}=e;const[l,d]=(0,r.useState)(s[c]);(0,r.useEffect)((()=>{d(s[c])}),[a,c,s]);return(0,o.jsxs)("div",{children:[(0,o.jsxs)("h4",{children:["Tracking Number #",c+1]}),(0,o.jsxs)("span",{children:[(0,o.jsx)("input",{placeholder:"Tracking Number",value:l,onChange:e=>{d(e.target.value)},onBlur:e=>{!async function(e){d(e.target.value);let t=s,r=n;t[c]=e.target.value,r.trackingNumberArr=t,await h(r),await u(i)}(e)}}),(0,o.jsx)("img",{src:g.Z,alt:"delete tracking number",onClick:()=>{!async function(){let e=n,t=s;t.splice(c,1),e.trackingNumberArr=t,await h(e),await u(i)}()}})]})]},t)}function j(e){let{orderItem:t,allOrders:s,setAllOrders:n,orderSearchInput:a}=e;const[c,l]=(0,r.useState)(t),d=new Date(c.dateCreated),p=new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds()),g=c.shippingAddress,j=c.cart.finalPriceInDollars,x=c.cart,[f,k]=(0,r.useState)(!1),[b,y]=(0,r.useState)(t.status),[S,w]=(0,r.useState)(t.giftMessage||""),T=async function(){let e=c,t=e.trackingNumberArr||[];t.push(""),e.trackingNumberArr=t,await h(e),await u(n,a)};return f?(0,o.jsxs)("li",{className:"order-item",children:[(0,o.jsxs)("button",{className:"order-item-expand-toggle",onClick:()=>{k(!f)},children:[(0,o.jsxs)("span",{className:"order-date",children:["Order Date: ",p.toDateString()]}),(0,o.jsxs)("span",{className:"order-id",children:["Order Number: #",c._id]})]}),(0,o.jsxs)("div",{className:"order-info-wrapper",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{children:"Order Status"}),(0,o.jsxs)("select",{value:b,onChange:e=>{!async function(e){let t=c;t.status=e,y(e),await h(t),await u(n,a)}(e.target.value)},children:[(0,o.jsx)("option",{children:"Pending"}),(0,o.jsx)("option",{children:"Processing"}),(0,o.jsx)("option",{children:"Shipped"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{children:"Shipping Address"}),(0,o.jsxs)("ul",{className:"order-item-shipping",children:[(0,o.jsx)("li",{children:g.fullName}),(0,o.jsx)("li",{children:g.phone}),(0,o.jsx)("li",{children:g.line1}),(0,o.jsx)("li",{children:g.city}),(0,o.jsxs)("li",{children:[g.state,", ",g.postal_code]}),(0,o.jsx)("li",{children:g.country})]})]}),(0,o.jsxs)("div",{className:"order-summary",children:[(0,o.jsx)("h4",{children:"Item Summary"}),(0,o.jsx)("ul",{children:x.items.map(((e,t)=>{const s=(0,i.Lb)(e);return(0,o.jsxs)("li",{children:[(0,o.jsxs)("span",{children:[e.quantity,"x ",e.itemData.name,", ",s,":"]}),(0,o.jsx)("span",{children:(0,o.jsxs)("strong",{children:["$",(e.unitPriceInDollars*e.quantity).toFixed(2)]})})]},t)}))})]}),(0,o.jsxs)("div",{className:"order-costs",children:[(0,o.jsx)("h4",{children:"Order Costs:"}),(0,o.jsxs)("p",{children:[(0,o.jsx)("span",{children:"Basket Subtotal:"}),(0,o.jsx)("span",{children:(0,o.jsxs)("strong",{children:["$",c.cart.subtotalInDollars.toFixed(2)]})})]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("span",{children:"Calculated Tax:"}),(0,o.jsx)("span",{children:(0,o.jsxs)("strong",{children:["$",c.cart.taxInDollars.toFixed(2)]})})]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("span",{children:"Shipping Cost:"}),(0,o.jsx)("span",{children:(0,o.jsx)("strong",{children:"Free"})})]}),c.cart.discountAmountInDollars>0?(0,o.jsxs)("p",{children:[(0,o.jsx)("span",{children:"Discount Applied:"}),(0,o.jsx)("span",{children:(0,o.jsxs)("strong",{children:["-$",c.cart.discountAmountInDollars.toFixed(2)]})})]}):null,(0,o.jsxs)("p",{children:[(0,o.jsx)("span",{children:"Total Cost:"}),(0,o.jsx)("span",{children:(0,o.jsxs)("strong",{children:["$",j.toFixed(2)]})})]})]}),c.trackingNumberArr&&c.trackingNumberArr.length>0?(0,o.jsxs)("div",{children:[c.trackingNumberArr.map(((e,t)=>(0,o.jsx)(m,{allOrders:s,setAllOrders:n,trackingNumberArr:c.trackingNumberArr||[],index:t,order:c,trackingNumber:e},t))),(0,o.jsx)("p",{onClick:()=>{T()},children:"Add a tracking number +"}),(0,o.jsxs)("p",{children:["The customer's selected ship date is",(0,o.jsx)("br",{}),(0,o.jsx)("strong",{children:new Date(c.cart.desiredShipDate).toUTCString().split(" ").slice(0,4).join(" ")}),"."]})]}):(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{children:"Tracking"}),(0,o.jsx)("p",{onClick:()=>{T()},children:"Add a tracking number +"}),(0,o.jsxs)("p",{children:["Your selected ship date is ",(0,o.jsx)("strong",{children:new Date(c.cart.desiredShipDate).toUTCString().split(" ").slice(0,4).join(" ")}),"."]})]},"noTracking"),""!==S?(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{children:"Gift Message:"}),(0,o.jsx)("input",{value:S,placeholder:"Gift Message",onChange:e=>{!async function(e){let t=c;t.giftMessage=e,w(e),await h(t),await u(n,a)}(e.target.value)}})]}):null]})]}):(0,o.jsxs)("button",{className:"order-item-expand-toggle",onClick:()=>{k(!f)},children:[(0,o.jsxs)("span",{className:"order-date",children:["Order Date: ",p.toUTCString().split(" ").slice(0,4).join(" ")]}),(0,o.jsxs)("span",{className:"order-id",children:["Order Number: #",c._id]})]})}const x=s.p+"static/media/gear.6128b185cf7cec976d9115940c450f6f.svg";function f(e){let{setAllOrders:t,allOrders:s}=e;const[n,a]=(0,r.useState)(!1),[i,c]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const e=s.filter((e=>{if("Processing"===e.status)return 1}));c(e)}),[s]),n?(0,o.jsxs)("section",{children:[(0,o.jsxs)("h3",{onClick:()=>{a(!1)},children:[(0,o.jsx)("img",{src:x,alt:"processing orders"}),(0,o.jsx)("span",{children:"Processing Orders"})]}),(0,o.jsx)("ul",{className:"processing-orders-wrapper",children:i.length>0?i.sort(((e,t)=>e.dateCreated>t.dateCreated?-1:1)).map(((e,r)=>(0,o.jsx)(j,{allOrders:s,orderItem:e,setAllOrders:t},r))):(0,o.jsx)("li",{children:"There are currently no processing orders!"})})]}):(0,o.jsx)("section",{children:(0,o.jsxs)("h3",{onClick:()=>{a(!0)},children:[(0,o.jsx)("img",{src:x,alt:"processing orders"}),(0,o.jsx)("span",{children:"Processing Orders"})]})})}function k(e){let{user:t}=e;const[s,n]=(0,r.useState)(!1),[a,i]=(0,r.useState)(null);return(0,r.useEffect)((()=>{!async function(){const e=await fetch("".concat((0,d.F1)(),"/api/admin/users/memberships/").concat(t._id),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}}),s=await e.json();s.membershipDoc?i(s.membershipDoc):i(null)}()}),[s,t._id]),(0,o.jsxs)("li",{children:[(0,o.jsx)("h3",{onClick:()=>{n(!s)},children:(0,o.jsxs)("strong",{children:["#",t._id]})}),(0,o.jsx)("div",{className:"user-content-wrapper",children:s&&a?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:["First Name: ",(0,o.jsx)("strong",{children:t.firstName})]}),(0,o.jsxs)("p",{children:["Last Name: ",(0,o.jsx)("strong",{children:t.lastName})]}),(0,o.jsxs)("p",{children:["Email: ",(0,o.jsx)("strong",{children:t.email})]}),(0,o.jsxs)("p",{children:["Access-Control Group: ",(0,o.jsx)("strong",{children:t.group||"N/A"})]}),(0,o.jsxs)("p",{children:["Date Created: ",(0,o.jsx)("strong",{children:new Date(t.dateCreated).toLocaleDateString()})]}),(0,o.jsxs)("p",{children:["Is Banned: ",(0,o.jsx)("strong",{children:t.frozen.toString()})]}),(0,o.jsxs)("p",{children:["Membership ID: ",(0,o.jsxs)("strong",{children:["#",a._id]})]}),(0,o.jsxs)("p",{children:["Membership Tier: ",(0,o.jsx)("strong",{children:a.tier})]}),(0,o.jsxs)("p",{children:["Membership Expiration Date: ",(0,o.jsx)("strong",{children:a.expirationDate?new Date(a.expirationDate).toLocaleDateString():"N/A"})]})]}):null})]})}const b=s.p+"static/media/magnifying-glass.0292941b644f9b9c23f4c7fbe056cefe.svg";function y(){const[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(""),[a,i]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{s?async function(){const e=await fetch("".concat((0,d.F1)(),"/api/admin/users/search/").concat(s),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}}),r=await e.json();r.results?t(r.results):t([])}():t([])}),[s]),a?(0,o.jsxs)("section",{children:[(0,o.jsxs)("h3",{onClick:()=>{i(!1)},children:[(0,o.jsx)("img",{src:b,alt:"search"}),(0,o.jsx)("span",{children:"User Search"})]}),(0,o.jsxs)("div",{className:"user-search-content-wrapper",children:[(0,o.jsx)("input",{className:"user-search-input",value:s,onChange:e=>{n(e.target.value)},placeholder:"Search By User ID To Find Users"}),(0,o.jsxs)("ul",{children:[0===e.length&&s?(0,o.jsxs)("p",{children:['No matches were found for "',s,'".']}):null,0===s.length?(0,o.jsx)("p",{children:"Enter a user ID to begin searching for a user."}):null,e.length>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:[e.length,' users were found matching "',s,'".']}),e.map(((e,t)=>(0,o.jsx)(k,{user:e},t)))]}):null]})]})]}):(0,o.jsx)("section",{children:(0,o.jsxs)("h3",{onClick:()=>{i(!0)},children:[(0,o.jsx)("img",{src:b,alt:"search"}),(0,o.jsx)("span",{children:"User Search"})]})})}function S(e){let{setAllOrders:t}=e;const[s,n]=(0,r.useState)(""),[a,i]=(0,r.useState)([]),[c,l]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{s?p(s,i):i([])}),[s]),(0,r.useEffect)((()=>{u(t)}),[a,t]),c?(0,o.jsxs)("section",{className:"order-search-panel-wrapper",children:[(0,o.jsxs)("h3",{onClick:()=>{l(!1)},children:[(0,o.jsx)("img",{src:b,alt:"search"}),(0,o.jsx)("span",{children:"Order Search"})]}),(0,o.jsxs)("div",{className:"order-search-content-wrapper",children:[(0,o.jsx)("input",{className:"order-search-input",value:s,onChange:e=>{n(e.target.value)},placeholder:"Search By Order ID To Find Orders"}),(0,o.jsxs)("ul",{className:"order-search-content",children:[0===a.length&&s?(0,o.jsxs)("li",{children:["No matches were found for order ID, ",s,"."]}):null,0===s.length?(0,o.jsx)("li",{children:"Enter a order ID to begin searching for a order."}):null,a.length>0?a.sort(((e,t)=>e.dateCreated>t.dateCreated?-1:1)).map(((e,t)=>(0,o.jsx)(j,{allOrders:a,setAllOrders:i,orderItem:e,orderSearchInput:s},t))):null]})]})]}):(0,o.jsx)("section",{children:(0,o.jsxs)("h3",{onClick:()=>{l(!0)},children:[(0,o.jsx)("img",{src:b,alt:"search"}),(0,o.jsx)("span",{children:"Order Search"})]})})}const w=s.p+"static/media/flag-solid.fecef8b949b1db1c1f0ae85f68ac86d6.svg";function T(e){let{allOrders:t,setAllOrders:s}=e;const[n,a]=(0,r.useState)(!1),[i,c]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const e=t.filter((e=>{if("Pending"===e.status)return 1}));c(e)}),[t]),n?(0,o.jsxs)("section",{children:[(0,o.jsxs)("h3",{onClick:()=>{a(!1)},children:[(0,o.jsx)("img",{src:w,alt:"pending orders"}),(0,o.jsx)("span",{children:"Pending Orders"})]}),(0,o.jsx)("ul",{className:"pending-orders-wrapper",children:i.length>0?i.sort(((e,t)=>e.dateCreated>t.dateCreated?-1:1)).map(((e,r)=>(0,o.jsx)(j,{allOrders:t,setAllOrders:s,orderItem:e},r))):(0,o.jsx)("li",{children:"There are currently no pending orders!"})})]}):(0,o.jsx)("section",{children:(0,o.jsxs)("h3",{onClick:()=>{a(!0)},children:[(0,o.jsx)("img",{src:w,alt:"pending orders"}),(0,o.jsx)("span",{children:"Pending Orders"})]})})}function C(e){let{allOrders:t}=e;const[s,n]=(0,r.useState)(!1),[a,l]=(0,r.useState)([]),[d,h]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const e=t.filter((e=>{if("Processing"===e.status)return 1}));h(e)}),[t]),(0,r.useEffect)((()=>{const e=[];d.forEach((t=>{t.cart.items.forEach((t=>{let s=null;e.map(((e,r)=>{t.itemData.name===e.itemData.name&&t.selection===e.selection&&t.itemData.cat===e.itemData.cat&&(s=r)})),s?e[s].quantity+=t.quantity:e.push(t)}))})),l(e)}),[d]),s?(0,o.jsxs)("section",{className:"pending-orders-panel-wrapper",children:[(0,o.jsxs)("h3",{onClick:()=>{n(!1)},children:[(0,o.jsx)("img",{alt:"processing",src:c}),(0,o.jsx)("span",{children:"Processing Orders Pulls"})]}),(0,o.jsx)("ul",{className:"pending-orders-panel-content",children:a?a.map(((e,t)=>(0,o.jsxs)("li",{children:[(0,o.jsx)("p",{children:e.itemData.name}),(0,o.jsx)("p",{children:e.quantity+" "+(0,i.Lb)(e)}),(0,o.jsx)("input",{type:"checkbox"})]},t))):null})]}):(0,o.jsx)("section",{children:(0,o.jsxs)("h3",{onClick:()=>{n(!0)},children:[(0,o.jsx)("img",{alt:"processing",src:c}),(0,o.jsx)("span",{children:"Processing Orders Pulls"})]})})}function D(){const[e,t]=(0,r.useState)(!1),[s,c]=(0,r.useState)(!0),[d,h]=(0,r.useState)([]),[p,g]=(0,r.useState)(!1),[m,j]=(0,r.useState)(i.UY),x=(0,r.useRef)(!0);return(0,r.useEffect)((()=>{x.current&&(x.current=!1,(0,i.sQ)(j),(0,n.UA)(c,t),u(h))}),[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.default,{cart:m,isExpanded:p,setIsExpanded:g,isSignedIn:s,setIsSignedIn:c}),e?(0,o.jsxs)("main",{className:"admin-panel-wrapper",onClick:()=>{g(!1)},children:[(0,o.jsx)(y,{}),(0,o.jsx)(S,{setAllOrders:h}),(0,o.jsx)(C,{allOrders:d}),(0,o.jsx)(l,{allOrders:d}),(0,o.jsx)(f,{allOrders:d,setAllOrders:h}),(0,o.jsx)(T,{allOrders:d,setAllOrders:h})]}):(0,o.jsx)("main",{children:"You don't have permission to access this content."})]})}},6795:(e,t,s)=>{s.d(t,{F1:()=>r,ki:()=>n});const r=function(){return"https://nybc-server-f069d08697f3.herokuapp.com"},n=function(){return"https://anthonygleason.github.io/NY-Bagels-Club-Client"};"".concat(r(),"/cart/checkout/success")},4545:(e,t,s)=>{s.d(t,{Fm:()=>a,UA:()=>i,gC:()=>n,hY:()=>c,sg:()=>o});var r=s(6795);const n=async function(e,t){const s=t?"clubCartToken":"cartToken";try{const t=await fetch("".concat((0,r.F1)(),"/api/shop/carts/verify"),{method:"GET",headers:{"Content-Type":"application/json","Cart-Token":"Bearer ".concat(localStorage.getItem(s)),Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}});if(200!==t.status)throw new Error("No valid cart detected. Either the user does not have a cart token or the token expired.");const n=await t.json();return e(n.cart),n.isValid}catch(n){return console.log(n),!1}},a=async function(e){const t=await fetch("".concat((0,r.F1)(),"/api/shop/carts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isClub:e})}),s=await t.json();if(s.cartToken)return s.cartToken},i=async function(e,t,s){let n=!1;if(!localStorage.getItem("loginToken"))return e&&e(!1),t&&t(!1),!1;try{const a=await fetch("".concat((0,r.F1)(),"/api/users/verify"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}}),i=await a.json();return!1===a.ok||403===a.status?(localStorage.removeItem("loginToken"),n=!1):n=i.isValid,t&&!0===i.isAdmin&&t(!0),e&&e(n),s&&s(i.userID),n}catch(a){return console.log(a),t&&t(!1),!1}},c=async function(e){await fetch("".concat((0,r.F1)(),"/api/users/logout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}}),e&&e(!1),localStorage.removeItem("loginToken")},o=async function(e,t,s){try{if(!localStorage.getItem("loginToken"))throw new Error("You are not signed in");const n=await fetch("".concat((0,r.F1)(),"/api/users/membershipLevel"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))}}),a=await n.json();return e&&e(a.membershipLevel),t&&t(a.remainingDeliveries),s&&s(new Date(a.expirationDate).toDateString()),a.membershipLevel}catch(n){return console.log("You are not signed in, showing non-member pricing."),e&&e("Non-Member"),"Non-Member"}}},7579:(e,t,s)=>{s.d(t,{Lb:()=>o,Lc:()=>c,UY:()=>h,W:()=>g,Z6:()=>l,pQ:()=>p,qi:()=>a,r:()=>d,sQ:()=>i,wp:()=>u});var r=s(6795),n=s(4545);const a=async function(e,t,s,i,c,o,l){let d="";d=!1===l?"cartToken":"clubCartToken";try{if(i)throw new Error("A request is already pending. Please wait for the current request to complete.");if(c(!0),!t||e<0)throw new Error("One or more required inputs were left blank.");if(!d)throw new Error("Your request for a local storage cart token was invalid. Did you provide a isClub value to this function?");const h=await fetch("".concat((0,r.F1)(),"/api/shop/carts"),{method:"PUT",headers:{"Content-Type":"application/json","Cart-Token":"Bearer ".concat(localStorage.getItem(d)),Authorization:"Bearer ".concat(localStorage.getItem("loginToken"))},body:JSON.stringify({itemID:t,updatedQuantity:e,selection:o,isClubCart:l||void 0})});if(510===h.status&&alert("You have reached the maximum allowed quantity for the selected item."),403===h.status&&(localStorage.setItem(d,await(0,n.Fm)(l||!1)),a(e,t,s,i,c,o,l)),!h.ok)throw new Error("An error occurred in the request to update the cart.");const u=await h.json();u.cartToken&&u.cart&&(localStorage.setItem(d,u.cartToken),s(u.cart)),c(!1)}catch(h){c(!1)}},i=async function(e,t){try{const s=t?"clubCartToken":"cartToken";localStorage.getItem(s)||localStorage.setItem(s,await(0,n.Fm)(t||!1)),await(0,n.gC)(e,t)||(localStorage.setItem(s,await(0,n.Fm)(t||!1)),e([]))}catch(s){console.log(s)}},c=function(e,t,s,r,n,i,c,o){const l=parseInt(e.target.value);l?a(l,s.itemData._id,r,n,i,c,o):t("")},o=function(e){return"bagel"===e.itemData.cat&&"six"===e.selection?"Six Pack(s)":"bagel"===e.itemData.cat&&"dozen"===e.selection?"Baker's Dozen(s)":"bagel"===e.itemData.cat&&"two"===e.selection?"Two Pack(s)":"spread"===e.itemData.cat&&"halflb"===e.selection?"1/2 LB":"spread"===e.itemData.cat?"One Pound":"pastry"===e.itemData.cat?"Six Pack(s)":"mystery"===e.itemData.cat?"Single(s)":"N/A"},l=function(e){return e.quantity*e.unitPriceInDollars},d=function(e,t,s){if(!e||!e.items)return 0;let r=0;for(let n=0;n<e.items.length;n++){const a=e.items[n];if(a.selection===s&&"bagel"===a.itemData.cat&&a.itemData.name===t){r=a.quantity;break}if("spread"===a.itemData.cat&&a.itemData.name===t){r=a.quantity;break}if("pastry"===a.itemData.cat&&a.itemData.name===t){r=a.quantity;break}}return r},h={items:[],subtotalInDollars:0,taxInDollars:0,totalQuantity:0,discountAmountInDollars:0,finalPriceInDollars:0,desiredShipDate:new Date,isGuest:!1},u=async function(e){const t=localStorage.getItem("cartToken"),s=localStorage.getItem("loginToken");if(t){const n=await fetch("".concat((0,r.F1)(),"/api/shop/carts/applyMembershipPricing"),{method:"POST",headers:{"Content-Type":"application/json","Cart-Token":"Bearer ".concat(t),Authorization:"Bearer ".concat(s)}});if(n.ok){const t=await n.json();localStorage.setItem("cartToken",t.cartToken),e&&e(t.cart),console.log("Membership pricing successfully applied!")}else console.log("User is not a member.")}},p=function(e){let t=0,s=0;return e.items.map((e=>{switch(e.itemData.cat){case"bagel":s+=e.quantity;break;case"spread":t+=e.quantity}})),1===t&&6===s},g=async function(e,t,s,n){if(t)if(n)if(s<=0)alert("You do not have any deliveries remaining this billing cycle.");else{const e=await fetch("".concat((0,r.F1)(),"/api/memberships/create-club-checkout-session"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("loginToken")),"cart-token":"Bearer ".concat(localStorage.getItem("clubCartToken"))},body:JSON.stringify({shipDate:n})}),t=await e.json();t.sessionUrl&&(window.location.href=t.sessionUrl)}else alert("You must select a ship date to place your order.");else alert('To place your order you must have 6 "Two Packs" and 1 "1/2 LB" spread in your cart.')}}}]);
//# sourceMappingURL=9822.70f5675e.chunk.js.map